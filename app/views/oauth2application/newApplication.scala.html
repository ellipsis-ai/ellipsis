@(
  config: ViewConfig,
  apis: Seq[json.OAuth2ApiData],
  applicationId: String,
  maybeApiId: Option[String],
  maybeRecommendedScope: Option[String],
  maybeBehaviorId: Option[String]
  )(implicit messages: Messages, r: RequestHeader)

@import play.filters.csrf._
@import play.api.libs.json._
@import json.Formatting._

@page.main("Add an API application", config, selectedNav = "settings") {
  <div id="content" class="content">
    <div id="applicationEditor"></div>
    <script>
      var ApplicationEditorConfig = {
        containerId: 'applicationEditor',
        csrfToken: "@CSRF.getToken(r).map(_.value)",
        teamId: "@config.maybeTargetTeamId.getOrElse("")",
        apis: @Html(Json.toJson(apis).toString),
        callbackUrl: "@routes.APIAccessController.linkCustomOAuth2Service(applicationId, None, None, None, None).absoluteURL(secure = true)",
        mainUrl: "@routes.ApplicationController.index().absoluteURL(secure = true)",
        applicationId: "@applicationId",
        applicationApiId: "@maybeApiId.getOrElse("")",
        recommendedScope: "@maybeRecommendedScope.getOrElse("")",
        behaviorId: "@maybeBehaviorId.getOrElse("")"
      };
    </script>
    <script data-main='@RemoteAssets.getUrl("javascripts/application_editor/loader.js")' src='@RemoteAssets.getUrl("lib/requirejs/require.min.js")'></script>
  </div>
}
