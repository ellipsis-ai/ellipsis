@(
  config: ViewConfig,
  maybeApi: Option[models.accounts.oauth2api.OAuth2Api],
  grantTypes: Seq[models.accounts.oauth2api.OAuth2GrantType]
  )(implicit messages: Messages, r: RequestHeader)

@import helper._

@page.main("Configure an external API", config) {

  <div id="content" class="content">
    <div class="container ptxxxxl">
      <h1 class="type-blue-faded">Configure an external API:</h1>

      <form action="@routes.OAuth2ApiController.save()" method="POST">
        @CSRF.formField
        @config.maybeTargetTeamId.map { id =>
          <input type="hidden" name="teamId" value="@id"/>
        }
        @maybeApi.map { api =>
          <input type="hidden" name="id" value="@api.id"/>
        }
        @field("Name of the external system", "name", maybeApi.map(_.name))
        <div class="columns">
          <div class="column column-one-third align-r">Grant type:</div>
          <div class="column column-one-half">
            <select name="grantType">
              @grantTypes.map { ea =>
                <option value="@ea.toString" @(if(maybeApi.exists(_.grantType.toString == ea.toString)) { "selected=selected" }) >@ea.toString</option>
              }
            </select>
          </div>
        </div>

        @field("Authorization URL", "authorizationUrl", maybeApi.flatMap(_.maybeAuthorizationUrl))
        @field("Access token URL", "accessTokenUrl", maybeApi.map(_.accessTokenUrl))
        @field("Where to add a new application", "newApplicationUrl", maybeApi.flatMap(_.maybeNewApplicationUrl))
        @field("Where to learn about scopes", "scopeDocumentationUrl", maybeApi.flatMap(_.maybeScopeDocumentationUrl))

        <div class="columns">
          <div class="column column-one-third align-r">&nbsp;</div>
          <div class="column column-one-half">
            <input type="submit" value="Save"/>
          </div>
        </div>
      </form>

    </div>
  </div>
}
