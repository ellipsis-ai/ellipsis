@(
  teamAccess: models.accounts.UserTeamAccess,
  apis: Seq[json.OAuth2ApiData],
  application: models.accounts.OAuth2Application
  )(implicit messages: Messages, r: RequestHeader)

@import play.filters.csrf._
@import play.api.libs.json._
@import json.Formatting._

@main("Edit API application", Some(teamAccess)) {
  @helper.javascriptRouter("jsRoutes")(
    routes.javascript.ApplicationController.saveOAuth2Application
  )
  <div id="content" class="content">
    <div id="applicationEditor"></div>
    <script>
      var ApplicationEditorConfig = {
        containerId: 'applicationEditor',
        csrfToken: "@CSRF.getToken(r).map(_.value)",
        teamId: "@teamAccess.maybeTargetTeam.map(_.id)",
        apis: @Html(Json.toJson(apis).toString),
        callbackUrl: "@routes.APIAccessController.linkCustomOAuth2Service(application.id, None, None, None).absoluteURL(secure = true)",
        applicationId: "@application.id",
        applicationName: "@application.name",
        applicationClientId: "@application.clientId",
        applicationSecret: "@application.clientSecret",
        applicationScope: "@application.maybeScope",
        applicationApi: {
          apiId: "@application.api.id",
          name: "@application.api.name"
        },
        applicationSaved: true
      };
    </script>
    <script data-main='@routes.Assets.versioned("javascripts/application_editor/loader.js")' src='@routes.Assets.versioned("lib/requirejs/require.min.js")'></script>
  </div>
}
